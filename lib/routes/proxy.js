'use strict';'use latest';var _express=require('express');var _express2=_interopRequireDefault(_express);var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);var _url=require('url');var _url2=_interopRequireDefault(_url);var _fs=require('fs');var _fs2=_interopRequireDefault(_fs);var _path=require('path');var _dotenv=require('dotenv');var _dotenv2=_interopRequireDefault(_dotenv);var _expressHttpProxy=require('express-http-proxy');var _expressHttpProxy2=_interopRequireDefault(_expressHttpProxy);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=function(){var router=_express2.default.Router();router.use('/api/whatweb',(0,_expressHttpProxy2.default)('whatweb.net',{decorateRequest:function decorateRequest(proxyReq,originalReq){proxyReq.headers['Content-Type']='application/x-www-form-urlencoded';proxyReq.method='POST';proxyReq.bodyContent='target='+(originalReq.body.target||originalReq.query.target);return proxyReq},forwardPath:function forwardPath(req,res){return'/whatweb.php'}}));router.use('/api/whois',(0,_expressHttpProxy2.default)('dns.com.ua',{decorateRequest:function decorateRequest(proxyReq,originalReq){proxyReq.headers['Content-Type']='application/x-www-form-urlencoded';proxyReq.method='POST';proxyReq.bodyContent='domain='+(originalReq.body.domain||originalReq.query.domain);return proxyReq},forwardPath:function forwardPath(req,res){return'/ajax/whois?domain='+(req.body.domain||req.query.domain)}}));router.use('/api',(0,_expressHttpProxy2.default)('http://'+hostname+':'+port,{forwardPath:function forwardPath(req,res){return'/api'+_url2.default.parse(req.url).path}}));return router}();